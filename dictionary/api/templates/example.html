<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ example.text }}</title>
    <link href="/static/css/slate.css" rel="stylesheet" />

</head>
<body>
    {% load rest_framework %}
    <div class="container">
        <div class="jumbotron">
            <div class="example" data-example-id="{{ example.id }}">
                <div class="h2">{{ example.text }}</div>
                <div class="h3">{{ song.title }}</div>
                {% for artist in primary_artists %}
                    <div class="h3 primary-artist" data-artist-id="{{ artist.id }}">{{ artist.name }}</div>
                {% endfor %}
                {% if feat_artists %}
                    <div class="h4">feat.
                    {% for artist in feat_artists %}
                        <span class="h3">{{ artist.name }}</span>{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                    </div>
                {% endif %}
                <div class="h3">{{ song.release_date }}</div>
                <br/>
            </div>
            <button class="btn btn-info btn-sm" onclick="getSelectionText();">Inject text</button>
            <br/>
            <br/>

            <br/>
            <div class="annotations list-group">
            {% for annotation in annotations %}
                <a href="{% url 'annotation-highlight' pk=annotation.id %}" class="list-group-item">{{ annotation.text }}</a>
            {% endfor %}
            </div>
            <form action="{% url 'annotation-list' %}" method="POST">
                {% csrf_token %}
                {% render_form annotation_serializer %}
                <input type="submit" value="Save">
            </form>
        </div>
    </div>
</body>
<script src="https://code.jquery.com/jquery-3.1.0.min.js"
        integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="
        crossorigin="anonymous">
</script>
<script>

    function getSelectionText() {
        var textSelection = window.getSelection();
        var text = $("[name='text']");
        text.val(textSelection.toString());

        var startPosition = $("[name='start_position']");
        startPosition.val(textSelection.anchorOffset);
        startPosition.attr("value", textSelection.anchorOffset);

        var endPosition = $("[name='end_position']");
        endPosition.val(textSelection.focusOffset);
        endPosition.attr("value", textSelection.focusOffset);
    }

</script>
</html>
